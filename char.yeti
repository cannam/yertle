
module char;

reader handle =
   (var next = "";
    reload () = (next := handle.read 1);
    reload ();
    {
        read () = (c = next; reload (); c),
        discard () = reload (),
        get next () = next,
        get isWhitespace () = (strIndexOf "\n\t\r " next 0 >= 0),
        get isEol () = (next == "\n" or next == "\r"),
        get isEof () = not defined? next,
    });

{ reader }
